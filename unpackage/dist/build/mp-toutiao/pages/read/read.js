(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/read/read"],{"630f":function(t,e,n){"use strict";var i,o=function(){var t=this,e=t.$createElement;t._self._c},r=[];n.d(e,"b",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return i})},6687:function(t,e,n){},a1dd:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n("a34a")),o=n("2f62");function r(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n,i,o,r,s){try{var a=t[r](s),c=a.value}catch(u){return void n(u)}a.done?e(c):Promise.resolve(c).then(i,o)}function a(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){s(r,i,o,a,c,"next",t)}function c(t){s(r,i,o,a,c,"throw",t)}a(void 0)})}}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){u(t,e,n[e])})}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h={data:function(){return{bookId:"",sectionId:"",book:{},showSet:!1,scrollHeight:0,cataloguelist:[],showCataMenu:!1,nightMode:!1,setFontSize:!0,fontSize:42,page:1,total:"",pickerlist:[],pickerIndex:0,preSectionId:"",isDisablePre:!1,nextSectionId:"",isDisableNext:!1,isBookShelf:!0}},onLoad:function(t){this.bookId=t.bId,this.sectionId=t.cId,this.getReadBookData(this.sectionId),this.getBookDirectoryData(),this.userId&&this.getIsBookShelf()},onReady:function(){var e=t.getSystemInfoSync().windowHeight,n=e-60-49;this.scrollHeight=2*n},onShow:function(){},onUnload:function(){var e=this;this.isBookShelf&&this.userId&&t.showModal({title:"加入收藏",content:"下次看书更方便",cancelText:"残忍拒绝",confirmText:"加入收藏",success:function(t){t.confirm?(console.log("确定"),e.addBookShelf()):t.cancel&&console.log("取消")}})},computed:c({},(0,o.mapGetters)(["userId","userInfo"])),methods:c({buyOneChapter:function(){var e=a(i.default.mark(function e(n){var o,r;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o={user_id:this.userId,book_id:this.bookId,chapter_id:n.chapter_id,price:n.price},t.showLoading({title:"正在购买..."}),e.next=4,this.$api.chapter.OneBuying(o);case 4:r=e.sent,t.hideLoading(),200===r.code?this.getReadBookData(n.cindex):t.showToast({icon:"none",title:r.msg});case 7:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),_inintUserInfo:function(){var t=a(i.default.mark(function t(){var e,n,o;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={user_id:this.userId},t.next=3,this.$api.user.UserInfo(e);case 3:n=t.sent,200===n.code&&(o=n.data,this.setUserInfo(o));case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setShowBtn:function(){this.showSet=!this.showSet},nigthModeBtn:function(){this.nightMode,tt.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:"#292929"}),this.nightMode=!this.nightMode,this.showSet=!1},showCataMenuBtn:function(){this.showCataMenu=!this.showCataMenu,this.showSet=!1},fontSizeBtn:function(){this.setFontSize=!this.setFontSize},subFontSizeBtn:function(){var t=this.fontSize;t<=20||(t-=4,this.fontSize=t)},addFontSizeBtn:function(){var t=this.fontSize;t>=98||(t+=4,this.fontSize=t)},addBookShelf:function(){var e=a(i.default.mark(function e(){var n,o;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.userId){e.next=8;break}return n={user_id:this.userId,book_id:this.bookId},e.next=4,this.$api.bookshelf.AddUserCase(n);case 4:o=e.sent,200===o.code?(t.showToast({title:"加入收藏成功",duration:2e3}),this.isBookShelf=!1):this.isBookShelf=!0,e.next=9;break;case 8:t.showToast({title:"请先登录",icon:"none",duration:2e3});case 9:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),gotoBookDetails:function(){t.navigateTo({url:"../detail/detail?id=".concat(this.bookId)})},selectCatalogue:function(t){this.showCataMenu=!1,this.showSet=!1,this.getReadBookData(t)},changePickerValue:function(t){var e=parseInt(t.detail.value);this.pickerIndex=e,this.page=e+1,this.getBookDirectoryData()},preChapter:function(){this.getReadBookData(this.preSectionId)},nextChapter:function(){this.getReadBookData(this.nextSectionId)},returnBtn:function(){},getIsBookShelf:function(){var t=a(i.default.mark(function t(){var e,n,o;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={user_id:this.userId,book_id:this.bookId},t.next=3,this.$api.bookshelf.BookIsCase(e);case 3:n=t.sent,200===n.code&&(o="Y"!==n.data.is_case,this.isBookShelf=o);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getReadBookData:function(){var e=a(i.default.mark(function e(n){var o,r,s,a;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o={book_id:this.bookId,user_id:this.userId,sort:n},e.next=3,this.$api.read.Chapter(o);case 3:r=e.sent,t.pageScrollTo({scrollTop:0,duration:0}),200===r.code&&(s=r.data,a=r.extra,t.setNavigationBarTitle({title:s.chapter_title}),this.book=s,this.sectionId=s.cindex,this.preSectionId=a.pre,this.nextSectionId=a.next,"Y"===s.is_fee&&this.userId&&this._inintUserInfo(),0===a.pre?this.isDisablePre=!0:this.isDisablePre=!1,0===a.next?this.isDisableNext=!0:this.isDisableNext=!1);case 6:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),getBookDirectoryData:function(){var t=a(i.default.mark(function t(){var e,n;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={book_id:this.bookId,page:this.page,rows:100},t.next=3,this.$api.book.Directory(e);case 3:n=t.sent,200===n.code&&(this.cataloguelist=n.data,this.total=n.extra.count,0===this.pickerlist.length&&this.setPickerData(n.extra.count));case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setPickerData:function(t){for(var e=[],n=Math.floor(t/100),i=0;i<=n;i++){var o=100*i+1,r=100*(i+1);r>t&&(r=t);var s=o+"-"+r;e.push(s)}this.pickerlist=e},gotoRecharge:function(){t.navigateTo({url:"/pages/recharge/recharge"})},gotoLogin:function(){t.switchTab({url:"/pages/user/user"})}},(0,o.mapMutations)(["setUserInfo"]))};e.default=h}).call(this,n("f266")["default"])},b029:function(t,e,n){"use strict";(function(t){n("7e18"),n("921b");i(n("66fd"));var e=i(n("dc8c"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("f266")["createPage"])},dc8c:function(t,e,n){"use strict";n.r(e);var i=n("630f"),o=n("fe41");for(var r in o)"default"!==r&&function(t){n.d(e,t,function(){return o[t]})}(r);n("f13e");var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"117f7edd",null,!1,i["a"],s);e["default"]=c.exports},f13e:function(t,e,n){"use strict";var i=n("6687"),o=n.n(i);o.a},fe41:function(t,e,n){"use strict";n.r(e);var i=n("a1dd"),o=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);e["default"]=o.a}},[["b029","common/runtime","common/vendor"]]]);